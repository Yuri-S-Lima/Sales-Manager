{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useContext, useEffect } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport BackHandler from \"react-native-web/dist/exports/BackHandler\";\nimport { InputBusca } from \"../components/InputBusca\";\nimport { Styles } from \"../components/Styles\";\nimport { db } from \"../util/Firebase\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport { Produtos } from \"../objeto/Produtos\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport function ClienteData(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useContext = useContext(AuthContext),\n      user = _useContext.user;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      produtos = _useState2[0],\n      setProdutos = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      id = _useState4[0],\n      setId = _useState4[1];\n\n  var _useState5 = useState(route.params.Divida),\n      _useState6 = _slicedToArray(_useState5, 2),\n      div = _useState6[0],\n      setDiv = _useState6[1];\n\n  var _useState7 = useState(route.params.Divida.toString()),\n      _useState8 = _slicedToArray(_useState7, 2),\n      devedor = _useState8[0],\n      setDev = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      Lucro = _useState10[0],\n      setLucro = _useState10[1];\n\n  useEffect(function () {\n    db.collection('Usuários').doc(user.uid).collection('Clientes').doc(route.params.id).collection('Produtos').onSnapshot(function (querySnapshot) {\n      setId(route.params.id);\n      console.log(\"id cd\", id);\n      var vendas = [];\n      var idPs = [];\n      querySnapshot.forEach(function (doc) {\n        vendas.push(doc.data());\n        idPs.push(doc.id);\n        console.log('pro', doc.data());\n      });\n      setProdutos(vendas);\n      db.collection('Usuários').doc(user.uid).onSnapshot(function (doc) {\n        setLucro(doc.data().Lucro);\n      });\n    });\n  }, []);\n\n  function editeCliente() {\n    navigation.navigate(\"EditarCliente\", {\n      Nome: route.params.Nome,\n      Id: id\n    });\n  }\n\n  function editeVenda(nomeProduto) {\n    navigation.navigate(\"EditarProduto\", {\n      produtos: produtos,\n      Nome: nomeProduto,\n      Id: id,\n      Divida: div\n    });\n  }\n\n  function deleteProduto(nome, valor) {\n    var ids = [];\n    var produtosNome = [];\n    var idFinal;\n    db.collection(\"Usuários\").doc(user.uid).collection(\"Clientes\").doc(id).collection(\"Produtos\").get().then(function (querySnapshot) {\n      querySnapshot.docs.forEach(function (doc) {\n        ids.push(doc.id);\n        produtosNome.push(doc.data().Nome);\n      });\n      var pos = produtosNome.indexOf(nome);\n\n      for (var i = 0; i < ids.length; i++) {\n        if (i === pos) {\n          idFinal = ids[i];\n          console.log(idFinal);\n        }\n      }\n\n      console.log(valor);\n      db.collection('Usuários').doc(user.uid).collection('Clientes').doc(id).collection(\"Produtos\").doc(idFinal).delete();\n      db.collection(\"Usuários\").doc(user.uid).collection(\"Clientes\").doc(id).update({\n        Divida: div - valor\n      }, setDiv(div - valor));\n      db.collection(\"Usuários\").doc(user.uid).update({\n        Lucro: Lucro - valor\n      });\n    });\n  }\n\n  return _jsx(View, {\n    style: {\n      flex: 1\n    },\n    children: _jsxs(SafeAreaView, {\n      style: {\n        flex: 1,\n        marginHorizontal: 25,\n        marginVertical: 50\n      },\n      children: [_jsxs(View, {\n        style: {\n          flexDirection: 'row',\n          alignItems: 'center',\n          justifyContent: 'space-between'\n        },\n        children: [_jsx(View, {\n          style: {\n            alignItems: 'center'\n          },\n          children: _jsx(Text, {\n            style: Styles.text5,\n            children: \"Ficha do Cliente\"\n          })\n        }), _jsx(TouchableOpacity, {\n          children: _jsx(Image, {\n            source: require(\"../../assets/icons/voltar.png\"),\n            style: {\n              width: 24,\n              height: 24\n            }\n          })\n        })]\n      }), _jsx(View, {\n        style: {\n          flex: 1,\n          justifyContent: 'center'\n        },\n        children: _jsxs(View, {\n          style: {\n            marginTop: 44,\n            flexDirection: 'row',\n            alignItems: 'center'\n          },\n          children: [_jsx(Text, {\n            style: Styles.text2,\n            children: route.params.Nome\n          }), _jsx(TouchableOpacity, {\n            style: {\n              marginLeft: 5\n            },\n            onPress: editeCliente,\n            children: _jsx(Image, {\n              source: require(\"../../assets/icons/editar.png\"),\n              style: {\n                width: 24,\n                height: 24\n              }\n            })\n          })]\n        })\n      }), produtos != null ? _jsx(FlatList, {\n        keyExtractor: function keyExtractor(item) {\n          return item.Nome;\n        },\n        data: produtos,\n        renderItem: function renderItem(_ref2) {\n          var item = _ref2.item;\n          return _jsxs(View, {\n            style: {\n              flexDirection: 'row',\n              justifyContent: 'space-between',\n              alignItems: 'center'\n            },\n            children: [_jsx(Text, {\n              style: Styles.text5,\n              children: item.Nome\n            }), _jsx(Text, {\n              style: Styles.text5,\n              children: item.Data\n            }), _jsx(Text, {\n              style: Styles.text2,\n              children: item.Preco\n            }), _jsx(TouchableOpacity, {\n              onPress: function onPress() {\n                deleteProduto(item.Nome, item.Preco);\n              },\n              children: _jsx(Image, {\n                source: require(\"../../assets/icons/delete.png\"),\n                style: {\n                  width: 24,\n                  height: 24\n                }\n              })\n            }), _jsx(TouchableOpacity, {\n              onPress: function onPress() {\n                editeVenda(item.Nome);\n              },\n              children: _jsx(Image, {\n                source: require(\"../../assets/icons/editar.png\"),\n                style: {\n                  width: 24,\n                  height: 24\n                }\n              })\n            })]\n          });\n        }\n      }) : _jsx(Text, {\n        style: Styles.textSocial,\n        children: \"CARREGANDO....\"\n      }), _jsxs(View, {\n        style: {\n          marginTop: 70\n        },\n        children: [_jsxs(View, {\n          style: {\n            flexDirection: 'row',\n            justifyContent: 'space-between',\n            alignItems: 'center'\n          },\n          children: [_jsx(Text, {\n            style: Styles.text2,\n            children: \"Saldo Devedor\"\n          }), _jsx(Text, {\n            style: Styles.text2,\n            children: \"R$ \" + devedor + \",00\"\n          })]\n        }), _jsxs(View, {\n          style: {\n            flexDirection: 'row',\n            justifyContent: 'space-between',\n            alignItems: 'center'\n          },\n          children: [_jsx(Text, {\n            style: Styles.text2,\n            children: \"Valor Pago\"\n          }), _jsx(Text, {\n            style: Styles.text2,\n            children: \"R$ 50\"\n          })]\n        })]\n      })]\n    })\n  });\n}","map":{"version":3,"sources":["/home/yuri/Programação/React/sales-manager/src/screens/ClienteData.js"],"names":["React","useState","useContext","useEffect","InputBusca","Styles","db","AuthContext","Produtos","ClienteData","navigation","route","user","produtos","setProdutos","id","setId","params","Divida","div","setDiv","toString","devedor","setDev","Lucro","setLucro","collection","doc","uid","onSnapshot","querySnapshot","console","log","vendas","idPs","forEach","push","data","editeCliente","navigate","Nome","Id","editeVenda","nomeProduto","deleteProduto","nome","valor","ids","produtosNome","idFinal","get","then","docs","pos","indexOf","i","length","delete","update","flex","marginHorizontal","marginVertical","flexDirection","alignItems","justifyContent","text5","require","width","height","marginTop","text2","marginLeft","item","Data","Preco","textSocial"],"mappings":"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","sourcesContent":["import React ,{ useState, useContext, useEffect } from \"react\";\nimport { View, SafeAreaView, TouchableOpacity, Text, Image, FlatList, BackHandler  } from 'react-native';\nimport { InputBusca } from \"../components/InputBusca\";\nimport { Styles } from \"../components/Styles\";\nimport { db } from \"../util/Firebase\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport { Produtos } from \"../objeto/Produtos\";\n\nexport function ClienteData({navigation, route}){\n\n    const { user } = useContext(AuthContext);\n    const [produtos, setProdutos] = useState(null);\n    const [id, setId] = useState('');\n    const [div, setDiv] = useState(route.params.Divida);\n    const [devedor, setDev] = useState(route.params.Divida.toString());\n    const [Lucro, setLucro] = useState(null);\n    \n    useEffect( () => {           \n        db.collection('Usuários').doc(user.uid).collection('Clientes').doc(route.params.id).collection('Produtos').onSnapshot((querySnapshot) => {\n            setId(route.params.id); \n            console.log(\"id cd\", id);\n            let vendas = [];  \n            let idPs = []   \n            querySnapshot.forEach((doc) => {\n                vendas.push(doc.data());\n                idPs.push(doc.id);\n                console.log('pro', doc.data())\n            });\n            setProdutos(vendas);\n        \n            db.collection('Usuários').doc(user.uid).onSnapshot((doc) => {\n                setLucro(doc.data().Lucro);       \n            })\n        });\n    }, [])\n           \n    function editeCliente(){\n        navigation.navigate(\"EditarCliente\", {Nome: route.params.Nome, Id: id});\n    }\n\n    function editeVenda(nomeProduto){\n        navigation.navigate(\"EditarProduto\", {produtos: produtos, Nome: nomeProduto, Id: id, Divida: div});\n    }\n\n    function deleteProduto(nome, valor){\n        let ids = []\n        let produtosNome = []\n        let idFinal;\n\n        db.collection(\"Usuários\").doc(user.uid).collection(\"Clientes\").doc(id).collection(\"Produtos\").get().then(querySnapshot => {\n            querySnapshot.docs.forEach(doc => {     \n                ids.push(doc.id);\n                produtosNome.push(doc.data().Nome);\n            });\n\n            let pos = produtosNome.indexOf(nome);\n           \n \n            for(var i = 0; i < ids.length; i++){\n                if(i === pos){\n                    idFinal = ids[i];\n                    console.log(idFinal)\n                }\n            }\n            console.log(valor)\n            db.collection('Usuários').doc(user.uid).collection('Clientes').doc(id).collection(\"Produtos\").doc(idFinal).delete()\n\n            db.collection(\"Usuários\").doc(user.uid).collection(\"Clientes\").doc(id).update({\n                Divida: div - valor,\n            },\n                setDiv(div - valor)\n            )\n\n            db.collection(\"Usuários\").doc(user.uid).update({\n                Lucro: Lucro - valor\n            })\n        })\n    }\n  \n    return(\n        <View style = {{flex: 1}}>\n            <SafeAreaView style = {{flex:1, marginHorizontal: 25, marginVertical: 50}}>\n\n                <View style = {{flexDirection:'row', alignItems:'center', justifyContent:'space-between'}}>\n\n                    <View style = {{alignItems:'center'}}>\n                        <Text style = {Styles.text5}>Ficha do Cliente</Text>\n                    </View>\n\n                    <TouchableOpacity>\n                        <Image source={require('../../assets/icons/voltar.png')} style={{ width: 24, height: 24 }} />\n                    </TouchableOpacity>\n\n                </View>\n                \n                <View style = {{flex:1, justifyContent:'center'}}>\n\n                    <View style = {{marginTop: 44, flexDirection:'row', alignItems:'center'}}>\n                        <Text style = {Styles.text2}>{route.params.Nome}</Text>\n                        <TouchableOpacity style = {{marginLeft: 5}} onPress = {editeCliente}><Image source = {require('../../assets/icons/editar.png')} style={{ width: 24, height: 24 }} /></TouchableOpacity>\n                    </View>\n\n                </View>  \n\n                { (produtos != null) ?\n                    <FlatList\n                        keyExtractor={(item) => item.Nome}\n                        data={produtos}\n                        renderItem={({ item }) =>       \n\n                            <View style = {{flexDirection:'row', justifyContent:'space-between', alignItems:'center'}}>\n                                <Text style = {Styles.text5}>{item.Nome}</Text>\n                                <Text style = {Styles.text5}>{item.Data}</Text>\n                                <Text style = {Styles.text2}>{item.Preco}</Text>\n                                <TouchableOpacity onPress={ () => {deleteProduto(item.Nome, item.Preco)}}><Image source = {require('../../assets/icons/delete.png')} style={{ width: 24, height: 24 }} /></TouchableOpacity>\n                                <TouchableOpacity onPress = {() => {editeVenda(item.Nome)}} ><Image source = {require('../../assets/icons/editar.png')} style={{ width: 24, height: 24 }} /></TouchableOpacity>\n                            </View>\n                            \n                        }\n                    /> : <Text style = {Styles.textSocial}>CARREGANDO....</Text>\n                }\n\n\n                <View style = {{marginTop: 70}}>\n                    <View style = {{flexDirection:'row', justifyContent:'space-between', alignItems:'center'}}>\n                        <Text style = {Styles.text2}>Saldo Devedor</Text>\n                        <Text style = {Styles.text2}>{`R$ ${devedor},00`}</Text>\n                    </View>\n\n                    <View style = {{flexDirection:'row', justifyContent:'space-between', alignItems:'center'}}>\n                        <Text style = {Styles.text2}>Valor Pago</Text>\n                        <Text style = {Styles.text2}>R$ 50</Text>\n                    </View>\n                </View>\n\n              \n\n            </SafeAreaView>\n        </View>\n    );\n}"]},"metadata":{},"sourceType":"module"}